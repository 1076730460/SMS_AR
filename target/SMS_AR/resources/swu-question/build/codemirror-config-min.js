!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}function n(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var n=e.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),e.refresh()}e.defineOption("fullScreen",!1,function(o,i,r){r==e.Init&&(r=!1),!r!=!i&&(i?t(o):n(o))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t){for(var n=0,o=e.length;o>n;++n)t(e[n])}function n(e,t){if(!Array.prototype.indexOf){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1}return-1!=e.indexOf(t)}function o(t,n,o,i){var r=t.getCursor(),s=o(t,r);if(!/\b(?:string|comment)\b/.test(s.type)){s.state=e.innerMode(t.getMode(),s.state).state,/^[\w$_]*$/.test(s.string)?s.end>r.ch&&(s.end=r.ch,s.string=s.string.slice(0,r.ch-s.start)):s={start:r.ch,end:r.ch,string:"",state:s.state,type:"."==s.string?"property":null};for(var c=s;"property"==c.type;){if(c=o(t,a(r.line,c.start)),"."!=c.string)return;if(c=o(t,a(r.line,c.start)),!f)var f=[];f.push(c)}return{list:l(s,f,n,i),from:a(r.line,s.start),to:a(r.line,s.end)}}}function i(e,t){return o(e,h,function(e,t){return e.getTokenAt(t)},t)}function r(e,t){var n=e.getTokenAt(t);return t.ch==n.start+1&&"."==n.string.charAt(0)?(n.end=n.start,n.string=".",n.type="property"):/^\.[\w$_]*$/.test(n.string)&&(n.type="property",n.start++,n.string=n.string.replace(/\./,"")),n}function s(e,t){return o(e,d,r,t)}function l(e,o,i,r){function s(e){0!=e.lastIndexOf(h,0)||n(a,e)||a.push(e)}function l(e){"string"==typeof e?t(c,s):e instanceof Array?t(f,s):e instanceof Function&&t(u,s);for(var n in e)s(n)}var a=[],h=e.string,d=r&&r.globalScope||window;if(o&&o.length){var p,g=o.pop();for(g.type&&0===g.type.indexOf("variable")?(r&&r.additionalContext&&(p=r.additionalContext[g.string]),r&&r.useGlobalScope===!1||(p=p||d[g.string])):"string"==g.type?p="":"atom"==g.type?p=1:"function"==g.type&&(null==d.jQuery||"$"!=g.string&&"jQuery"!=g.string||"function"!=typeof d.jQuery?null!=d._&&"_"==g.string&&"function"==typeof d._&&(p=d._()):p=d.jQuery());null!=p&&o.length;)p=p[o.pop().string];null!=p&&l(p)}else{for(var m=e.state.localVars;m;m=m.next)s(m.name);for(var m=e.state.globalVars;m;m=m.next)s(m.name);r&&r.useGlobalScope===!1||l(d),t(i,s)}return a}var a=e.Pos;e.registerHelper("hint","javascript",i),e.registerHelper("hint","coffeescript",s);var c="charAt charCodeAt indexOf lastIndexOf substring substr slice trim trimLeft trimRight toUpperCase toLowerCase split concat match replace search".split(" "),f="length concat join splice push pop shift unshift slice reverse sort indexOf lastIndexOf every some filter forEach map reduce reduceRight ".split(" "),u="prototype apply call bind".split(" "),h="break case catch continue debugger default delete do else false finally for function if in instanceof new null return switch throw true try typeof var void while with".split(" "),d="and break catch class continue delete do else extends false finally for if in instanceof isnt new no not null of off on or return switch then throw true try typeof until void while with yes".split(" ")}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){this.cm=e,this.options=this.buildOptions(t),this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor(),this.startLen=this.cm.getLine(this.startPos.line).length;var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}function n(e){return"string"==typeof e?e:e.text}function o(e,t){function n(e,n){var i;i="string"!=typeof n?function(e){return n(e,t)}:o.hasOwnProperty(n)?o[n]:n,r[e]=i}var o={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(-t.menuSize()+1,!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},i=e.options.customKeys,r=i?{}:o;if(i)for(var s in i)i.hasOwnProperty(s)&&n(s,i[s]);var l=e.options.extraKeys;if(l)for(var s in l)l.hasOwnProperty(s)&&n(s,l[s]);return r}function i(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function r(t,r){this.completion=t,this.data=r,this.picked=!1;var a=this,c=t.cm,f=this.hints=document.createElement("ul");f.className="CodeMirror-hints",this.selectedHint=r.selectedHint||0;for(var u=r.list,h=0;h<u.length;++h){var d=f.appendChild(document.createElement("li")),p=u[h],g=s+(h!=this.selectedHint?"":" "+l);null!=p.className&&(g=p.className+" "+g),d.className=g,p.render?p.render(d,r,p):d.appendChild(document.createTextNode(p.displayText||n(p))),d.hintId=h}var m=c.cursorCoords(t.options.alignWithWord?r.from:null),v=m.left,y=m.bottom,b=!0;f.style.left=v+"px",f.style.top=y+"px";var C=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),x=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(t.options.container||document.body).appendChild(f);var w=f.getBoundingClientRect(),k=w.bottom-x;if(k>0){var S=w.bottom-w.top,L=m.top-(m.bottom-w.top);if(L-S>0)f.style.top=(y=m.top-S)+"px",b=!1;else if(S>x){f.style.height=x-5+"px",f.style.top=(y=m.bottom-w.top)+"px";var M=c.getCursor();r.from.ch!=M.ch&&(m=c.cursorCoords(M),f.style.left=(v=m.left)+"px",w=f.getBoundingClientRect())}}var T=w.right-C;if(T>0&&(w.right-w.left>C&&(f.style.width=C-5+"px",T-=w.right-w.left-C),f.style.left=(v=m.left-T)+"px"),c.addKeyMap(this.keyMap=o(t,{moveFocus:function(e,t){a.changeActive(a.selectedHint+e,t)},setFocus:function(e){a.changeActive(e)},menuSize:function(){return a.screenAmount()},length:u.length,close:function(){t.close()},pick:function(){a.pick()},data:r})),t.options.closeOnUnfocus){var O;c.on("blur",this.onBlur=function(){O=setTimeout(function(){t.close()},100)}),c.on("focus",this.onFocus=function(){clearTimeout(O)})}var A=c.getScrollInfo();return c.on("scroll",this.onScroll=function(){var e=c.getScrollInfo(),n=c.getWrapperElement().getBoundingClientRect(),o=y+A.top-e.top,i=o-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return b||(i+=f.offsetHeight),i<=n.top||i>=n.bottom?t.close():(f.style.top=o+"px",void(f.style.left=v+A.left-e.left+"px"))}),e.on(f,"dblclick",function(e){var t=i(f,e.target||e.srcElement);t&&null!=t.hintId&&(a.changeActive(t.hintId),a.pick())}),e.on(f,"click",function(e){var n=i(f,e.target||e.srcElement);n&&null!=n.hintId&&(a.changeActive(n.hintId),t.options.completeOnSingleClick&&a.pick())}),e.on(f,"mousedown",function(){setTimeout(function(){c.focus()},20)}),e.signal(r,"select",u[0],f.firstChild),!0}var s="CodeMirror-hint",l="CodeMirror-hint-active";e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var o={hint:t};if(n)for(var i in n)o[i]=n[i];return e.showHint(o)},e.defineExtension("showHint",function(n){if(!(this.listSelections().length>1||this.somethingSelected())){this.state.completionActive&&this.state.completionActive.close();var o=this.state.completionActive=new t(this,n);o.options.hint&&(e.signal(this,"startCompletion",this),o.update(!0))}});var a=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},c=window.cancelAnimationFrame||clearTimeout;t.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,o){var i=t.list[o];i.hint?i.hint(this.cm,t,i):this.cm.replaceRange(n(i),i.from||t.from,i.to||t.to,"complete"),e.signal(t,"pick",i),this.close()},cursorActivity:function(){this.debounce&&(c(this.debounce),this.debounce=0);var e=this.cm.getCursor(),t=this.cm.getLine(e.line);if(e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1)))this.close();else{var n=this;this.debounce=a(function(){n.update()}),this.widget&&this.widget.disable()}},update:function(e){if(null!=this.tick)if(this.options.hint.async){var t=++this.tick,n=this;this.options.hint(this.cm,function(o){n.tick==t&&n.finishUpdate(o,e)},this.options)}else this.finishUpdate(this.options.hint(this.cm,this.options),e)},finishUpdate:function(t,n){this.data&&e.signal(this.data,"update"),t&&this.data&&e.cmpPos(t.from,this.data.from)&&(t=null),this.data=t;var o=this.widget&&this.widget.picked||n&&this.options.completeSingle;this.widget&&this.widget.close(),t&&t.list.length&&(o&&1==t.list.length?this.pick(t,0):(this.widget=new r(this,t),e.signal(t,"shown")))},buildOptions:function(e){var t=this.cm.options.hintOptions,n={};for(var o in f)n[o]=f[o];if(t)for(var o in t)void 0!==t[o]&&(n[o]=t[o]);if(e)for(var o in e)void 0!==e[o]&&(n[o]=e[o]);return n}},r.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,n){if(t>=this.data.list.length?t=n?this.data.list.length-1:0:0>t&&(t=n?0:this.data.list.length-1),this.selectedHint!=t){var o=this.hints.childNodes[this.selectedHint];o.className=o.className.replace(" "+l,""),o=this.hints.childNodes[this.selectedHint=t],o.className+=" "+l,o.offsetTop<this.hints.scrollTop?this.hints.scrollTop=o.offsetTop-3:o.offsetTop+o.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=o.offsetTop+o.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],o)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",function(t,n){var o,i=t.getHelpers(t.getCursor(),"hint");if(i.length)for(var r=0;r<i.length;r++){var s=i[r](t,n);if(s&&s.list.length)return s}else if(o=t.getHelper(t.getCursor(),"hintWords")){if(o)return e.hint.fromList(t,{words:o})}else if(e.hint.anyword)return e.hint.anyword(t,n)}),e.registerHelper("hint","fromList",function(t,n){var o=t.getCursor(),i=t.getTokenAt(o),r=e.Pos(o.line,i.end);if(i.string&&/\w/.test(i.string[i.string.length-1]))var s=i.string,l=e.Pos(o.line,i.start);else var s="",l=r;for(var a=[],c=0;c<n.words.length;c++){var f=n.words[c];f.slice(0,s.length)==s&&a.push(f)}return a.length?{list:a,from:l,to:r}:void 0}),e.commands.autocomplete=e.showHint;var f={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!1,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,n,o){function i(t){var n=e.wheelEventPixels(t)["horizontal"==r.orientation?"x":"y"],o=r.pos;r.moveTo(r.pos+n),r.pos!=o&&e.e_preventDefault(t)}this.orientation=n,this.scroll=o,this.screen=this.total=this.size=1,this.pos=0,this.node=document.createElement("div"),this.node.className=t+"-"+n,this.inner=this.node.appendChild(document.createElement("div"));var r=this;e.on(this.inner,"mousedown",function(t){function n(){e.off(document,"mousemove",o),e.off(document,"mouseup",n)}function o(e){return 1!=e.which?n():void r.moveTo(l+(e[i]-s)*(r.total/r.size))}if(1==t.which){e.e_preventDefault(t);var i="horizontal"==r.orientation?"pageX":"pageY",s=t[i],l=r.pos;e.on(document,"mousemove",o),e.on(document,"mouseup",n)}}),e.on(this.node,"click",function(t){e.e_preventDefault(t);var n,o=r.inner.getBoundingClientRect();n="horizontal"==r.orientation?t.clientX<o.left?-1:t.clientX>o.right?1:0:t.clientY<o.top?-1:t.clientY>o.bottom?1:0,r.moveTo(r.pos+n*r.screen)}),e.on(this.node,"mousewheel",i),e.on(this.node,"DOMMouseScroll",i)}function n(e,n,o){this.addClass=e,this.horiz=new t(e,"horizontal",o),n(this.horiz.node),this.vert=new t(e,"vertical",o),n(this.vert.node),this.width=null}t.prototype.moveTo=function(e,t){0>e&&(e=0),e>this.total-this.screen&&(e=this.total-this.screen),e!=this.pos&&(this.pos=e,this.inner.style["horizontal"==this.orientation?"left":"top"]=e*(this.size/this.total)+"px",t!==!1&&this.scroll(e,this.orientation))};var o=10;t.prototype.update=function(e,t,n){this.screen=t,this.total=e,this.size=n;var i=this.screen*(this.size/this.total);o>i&&(this.size-=o-i,i=o),this.inner.style["horizontal"==this.orientation?"width":"height"]=i+"px",this.inner.style["horizontal"==this.orientation?"left":"top"]=this.pos*(this.size/this.total)+"px"},n.prototype.update=function(e){if(null==this.width){var t=window.getComputedStyle?window.getComputedStyle(this.horiz.node):this.horiz.node.currentStyle;t&&(this.width=parseInt(t.height))}var n=this.width||0,o=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1;return this.vert.node.style.display=i?"block":"none",this.horiz.node.style.display=o?"block":"none",i&&(this.vert.update(e.scrollHeight,e.clientHeight,e.viewHeight-(o?n:0)),this.vert.node.style.display="block",this.vert.node.style.bottom=o?n+"px":"0"),o&&(this.horiz.update(e.scrollWidth,e.clientWidth,e.viewWidth-(i?n:0)-e.barLeft),this.horiz.node.style.right=i?n+"px":"0",this.horiz.node.style.left=e.barLeft+"px"),{right:i?n:0,bottom:o?n:0}},n.prototype.setScrollTop=function(e){this.vert.moveTo(e,!1)},n.prototype.setScrollLeft=function(e){this.horiz.moveTo(e,!1)},n.prototype.clear=function(){var e=this.horiz.node.parentNode;e.removeChild(this.horiz.node),e.removeChild(this.vert.node)},e.scrollbarModel.simple=function(e,t){return new n("CodeMirror-simplescroll",e,t)},e.scrollbarModel.overlay=function(e,t){return new n("CodeMirror-overlayscroll",e,t)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],e):e(CodeMirror)}(function(e){"use strict";function t(t,n,o){if(0>o&&0==n.ch)return t.clipPos(h(n.line-1));var i=t.getLine(n.line);if(o>0&&n.ch>=i.length)return t.clipPos(h(n.line+1,0));for(var r,s="start",l=n.ch,a=0>o?0:i.length,c=0;l!=a;l+=o,c++){var f=i.charAt(0>o?l-1:l),u="_"!=f&&e.isWordChar(f)?"w":"o";if("w"==u&&f.toUpperCase()==f&&(u="W"),"start"==s)"o"!=u&&(s="in",r=u);else if("in"==s&&r!=u){if("w"==r&&"W"==u&&0>o&&l--,"W"==r&&"w"==u&&o>0){r="w";continue}break}}return h(n.line,l)}function n(e,n){e.extendSelectionsBy(function(o){return e.display.shift||e.doc.extend||o.empty()?t(e.doc,o.head,n):0>n?o.from():o.to()})}function o(e,t){e.operation(function(){for(var n=e.listSelections().length,o=[],i=-1,r=0;n>r;r++){var s=e.listSelections()[r].head;if(!(s.line<=i)){var l=h(s.line+(t?0:1),0);e.replaceRange("\n",l,null,"+insertLine"),e.indentLine(l.line,null,!0),o.push({head:l,anchor:l}),i=s.line+1}}e.setSelections(o)})}function i(t,n){for(var o=n.ch,i=o,r=t.getLine(n.line);o&&e.isWordChar(r.charAt(o-1));)--o;for(;i<r.length&&e.isWordChar(r.charAt(i));)++i;return{from:h(n.line,o),to:h(n.line,i),word:r.slice(o,i)}}function r(e){var t=e.getCursor(),n=e.scanForBracket(t,-1);if(n)for(;;){var o=e.scanForBracket(t,1);if(!o)return;if(o.ch==m.charAt(m.indexOf(n.ch)+1))return e.setSelection(h(n.pos.line,n.pos.ch+1),o.pos,!1),!0;t=h(o.pos.line,o.pos.ch+1)}}function s(e,t){for(var n,o=e.listSelections(),i=[],r=0;r<o.length;r++){var s=o[r];if(!s.empty()){for(var l=s.from().line,a=s.to().line;r<o.length-1&&o[r+1].from().line==a;)a=s[++r].to().line;i.push(l,a)}}i.length?n=!0:i.push(e.firstLine(),e.lastLine()),e.operation(function(){for(var o=[],r=0;r<i.length;r+=2){var s=i[r],l=i[r+1],a=h(s,0),c=h(l),f=e.getRange(a,c,!1);t?f.sort():f.sort(function(e,t){var n=e.toUpperCase(),o=t.toUpperCase();return n!=o&&(e=n,t=o),t>e?-1:e==t?0:1}),e.replaceRange(f,a,c),n&&o.push({anchor:a,head:c})}n&&e.setSelections(o,0)})}function l(t,n){t.operation(function(){for(var o=t.listSelections(),r=[],s=[],l=0;l<o.length;l++){var a=o[l];a.empty()?(r.push(l),s.push("")):s.push(n(t.getRange(a.from(),a.to())))}t.replaceSelections(s,"around","case");for(var c,l=r.length-1;l>=0;l--){var a=o[r[l]];if(!(c&&e.cmpPos(a.head,c)>0)){var f=i(t,a.head);c=f.from,t.replaceRange(n(f.word),f.from,f.to)}}})}function a(t){var n=t.getCursor("from"),o=t.getCursor("to");if(0==e.cmpPos(n,o)){var r=i(t,n);if(!r.word)return;n=r.from,o=r.to}return{from:n,to:o,query:t.getRange(n,o),word:r}}function c(e,t){var n=a(e);if(n){var o=n.query,i=e.getSearchCursor(o,t?n.to:n.from);(t?i.findNext():i.findPrevious())?e.setSelection(i.from(),i.to()):(i=e.getSearchCursor(o,t?h(e.firstLine(),0):e.clipPos(h(e.lastLine()))),(t?i.findNext():i.findPrevious())?e.setSelection(i.from(),i.to()):n.word&&e.setSelection(n.from,n.to))}}var f=e.keyMap.sublime={fallthrough:"default"},u=e.commands,h=e.Pos,d=e.keyMap["default"]==e.keyMap.macDefault,p=d?"Cmd-":"Ctrl-";u[f["Alt-Left"]="goSubwordLeft"]=function(e){n(e,-1)},u[f["Alt-Right"]="goSubwordRight"]=function(e){n(e,1)};var g=d?"Ctrl-Alt-":"Ctrl-";u[f[g+"Up"]="scrollLineUp"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top+t.clientHeight,"local");e.getCursor().line>=n&&e.execCommand("goLineUp")}e.scrollTo(null,t.top-e.defaultTextHeight())},u[f[g+"Down"]="scrollLineDown"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top,"local")+1;e.getCursor().line<=n&&e.execCommand("goLineDown")}e.scrollTo(null,t.top+e.defaultTextHeight())},u[f["Shift-"+p+"L"]="splitSelectionByLine"]=function(e){for(var t=e.listSelections(),n=[],o=0;o<t.length;o++)for(var i=t[o].from(),r=t[o].to(),s=i.line;s<=r.line;++s)r.line>i.line&&s==r.line&&0==r.ch||n.push({anchor:s==i.line?i:h(s,0),head:s==r.line?r:h(s)});e.setSelections(n,0)},f["Shift-Tab"]="indentLess",u[f.Esc="singleSelectionTop"]=function(e){var t=e.listSelections()[0];e.setSelection(t.anchor,t.head,{scroll:!1})},u[f[p+"L"]="selectLine"]=function(e){for(var t=e.listSelections(),n=[],o=0;o<t.length;o++){var i=t[o];n.push({anchor:h(i.from().line,0),head:h(i.to().line+1,0)})}e.setSelections(n)},f["Shift-"+p+"K"]="deleteLine",u[f[p+"Enter"]="insertLineAfter"]=function(e){o(e,!1)},u[f["Shift-"+p+"Enter"]="insertLineBefore"]=function(e){o(e,!0)},u[f[p+"D"]="selectNextOccurrence"]=function(t){var n=t.getCursor("from"),o=t.getCursor("to"),r=t.state.sublimeFindFullWord==t.doc.sel;if(0==e.cmpPos(n,o)){var s=i(t,n);if(!s.word)return;t.setSelection(s.from,s.to),r=!0}else{var l=t.getRange(n,o),a=r?new RegExp("\\b"+l+"\\b"):l,c=t.getSearchCursor(a,o);c.findNext()?t.addSelection(c.from(),c.to()):(c=t.getSearchCursor(a,h(t.firstLine(),0)),c.findNext()&&t.addSelection(c.from(),c.to()))}r&&(t.state.sublimeFindFullWord=t.doc.sel)};var m="(){}[]";u[f["Shift-"+p+"Space"]="selectScope"]=function(e){r(e)||e.execCommand("selectAll")},u[f["Shift-"+p+"M"]="selectBetweenBrackets"]=function(t){return r(t)?void 0:e.Pass},u[f[p+"M"]="goToBracket"]=function(t){t.extendSelectionsBy(function(n){var o=t.scanForBracket(n.head,1);if(o&&0!=e.cmpPos(o.pos,n.head))return o.pos;var i=t.scanForBracket(n.head,-1);return i&&h(i.pos.line,i.pos.ch+1)||n.head})};var v=d?"Cmd-Ctrl-":"Shift-Ctrl-";u[f[v+"Up"]="swapLineUp"]=function(e){for(var t=e.listSelections(),n=[],o=e.firstLine()-1,i=[],r=0;r<t.length;r++){var s=t[r],l=s.from().line-1,a=s.to().line;i.push({anchor:h(s.anchor.line-1,s.anchor.ch),head:h(s.head.line-1,s.head.ch)}),0!=s.to().ch||s.empty()||--a,l>o?n.push(l,a):n.length&&(n[n.length-1]=a),o=a}e.operation(function(){for(var t=0;t<n.length;t+=2){var o=n[t],r=n[t+1],s=e.getLine(o);e.replaceRange("",h(o,0),h(o+1,0),"+swapLine"),r>e.lastLine()?e.replaceRange("\n"+s,h(e.lastLine()),null,"+swapLine"):e.replaceRange(s+"\n",h(r,0),null,"+swapLine")}e.setSelections(i),e.scrollIntoView()})},u[f[v+"Down"]="swapLineDown"]=function(e){for(var t=e.listSelections(),n=[],o=e.lastLine()+1,i=t.length-1;i>=0;i--){var r=t[i],s=r.to().line+1,l=r.from().line;0!=r.to().ch||r.empty()||s--,o>s?n.push(s,l):n.length&&(n[n.length-1]=l),o=l}e.operation(function(){for(var t=n.length-2;t>=0;t-=2){var o=n[t],i=n[t+1],r=e.getLine(o);o==e.lastLine()?e.replaceRange("",h(o-1),h(o),"+swapLine"):e.replaceRange("",h(o,0),h(o+1,0),"+swapLine"),e.replaceRange(r+"\n",h(i,0),null,"+swapLine")}e.scrollIntoView()})},f[p+"/"]="toggleComment",u[f[p+"J"]="joinLines"]=function(e){for(var t=e.listSelections(),n=[],o=0;o<t.length;o++){for(var i=t[o],r=i.from(),s=r.line,l=i.to().line;o<t.length-1&&t[o+1].from().line==l;)l=t[++o].to().line;n.push({start:s,end:l,anchor:!i.empty()&&r})}e.operation(function(){for(var t=0,o=[],i=0;i<n.length;i++){for(var r,s=n[i],l=s.anchor&&h(s.anchor.line-t,s.anchor.ch),a=s.start;a<=s.end;a++){var c=a-t;a==s.end&&(r=h(c,e.getLine(c).length+1)),c<e.lastLine()&&(e.replaceRange(" ",h(c),h(c+1,/^\s*/.exec(e.getLine(c+1))[0].length)),++t)}o.push({anchor:l||r,head:r})}e.setSelections(o,0)})},u[f["Shift-"+p+"D"]="duplicateLine"]=function(e){e.operation(function(){for(var t=e.listSelections().length,n=0;t>n;n++){var o=e.listSelections()[n];o.empty()?e.replaceRange(e.getLine(o.head.line)+"\n",h(o.head.line,0)):e.replaceRange(e.getRange(o.from(),o.to()),o.from())}e.scrollIntoView()})},f[p+"T"]="transposeChars",u[f.F9="sortLines"]=function(e){s(e,!0)},u[f[p+"F9"]="sortLinesInsensitive"]=function(e){s(e,!1)},u[f.F2="nextBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){var n=t.shift(),o=n.find();if(o)return t.push(n),e.setSelection(o.from,o.to)}},u[f["Shift-F2"]="prevBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){t.unshift(t.pop());var n=t[t.length-1].find();if(n)return e.setSelection(n.from,n.to);t.pop()}},u[f[p+"F2"]="toggleBookmark"]=function(e){for(var t=e.listSelections(),n=e.state.sublimeBookmarks||(e.state.sublimeBookmarks=[]),o=0;o<t.length;o++){for(var i=t[o].from(),r=t[o].to(),s=e.findMarks(i,r),l=0;l<s.length;l++)if(s[l].sublimeBookmark){s[l].clear();for(var a=0;a<n.length;a++)n[a]==s[l]&&n.splice(a--,1);break}l==s.length&&n.push(e.markText(i,r,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},u[f["Shift-"+p+"F2"]="clearBookmarks"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(var n=0;n<t.length;n++)t[n].clear();t.length=0},u[f["Alt-F2"]="selectBookmarks"]=function(e){var t=e.state.sublimeBookmarks,n=[];if(t)for(var o=0;o<t.length;o++){var i=t[o].find();i?n.push({anchor:i.from,head:i.to}):t.splice(o--,0)}n.length&&e.setSelections(n,0)},f["Alt-Q"]="wrapLines";var y=p+"K ";f[y+p+"Backspace"]="delLineLeft",u[f.Backspace="smartBackspace"]=function(t){if(t.somethingSelected())return e.Pass;var n=t.getCursor(),o=t.getRange({line:n.line,ch:0},n),i=e.countColumn(o,null,t.getOption("tabSize")),r=t.getOption("indentUnit");if(o&&!/\S/.test(o)&&i%r==0){var s=new h(n.line,e.findColumn(o,i-r,r));return s.ch==n.ch?e.Pass:t.replaceRange("",s,n,"+delete")}return e.Pass},u[f[y+p+"K"]="delLineRight"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange("",t[n].anchor,h(t[n].to().line),"+delete");e.scrollIntoView()})},u[f[y+p+"U"]="upcaseAtCursor"]=function(e){l(e,function(e){return e.toUpperCase()})},u[f[y+p+"L"]="downcaseAtCursor"]=function(e){l(e,function(e){return e.toLowerCase()})},u[f[y+p+"Space"]="setSublimeMark"]=function(e){e.state.sublimeMark&&e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor())},u[f[y+p+"A"]="selectToSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&e.setSelection(e.getCursor(),t)},u[f[y+p+"W"]="deleteToSublimeMark"]=function(t){var n=t.state.sublimeMark&&t.state.sublimeMark.find();if(n){var o=t.getCursor(),i=n;if(e.cmpPos(o,i)>0){var r=i;i=o,o=r}t.state.sublimeKilled=t.getRange(o,i),t.replaceRange("",o,i)}},u[f[y+p+"X"]="swapWithSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&(e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor()),e.setCursor(t))},u[f[y+p+"Y"]="sublimeYank"]=function(e){null!=e.state.sublimeKilled&&e.replaceSelection(e.state.sublimeKilled,null,"paste")},f[y+p+"G"]="clearBookmarks",u[f[y+p+"C"]="showInCenter"]=function(e){var t=e.cursorCoords(null,"local");e.scrollTo(null,(t.top+t.bottom)/2-e.getScrollInfo().clientHeight/2)},u[f["Shift-Alt-Up"]="selectLinesUpward"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=0;n<t.length;n++){var o=t[n];o.head.line>e.firstLine()&&e.addSelection(h(o.head.line-1,o.head.ch))}})},u[f["Shift-Alt-Down"]="selectLinesDownward"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=0;n<t.length;n++){var o=t[n];o.head.line<e.lastLine()&&e.addSelection(h(o.head.line+1,o.head.ch))}})},u[f[p+"F3"]="findUnder"]=function(e){c(e,!0)},u[f["Shift-"+p+"F3"]="findUnderPrevious"]=function(e){c(e,!1)},u[f["Alt-F3"]="findAllUnder"]=function(e){var t=a(e);if(t){for(var n=e.getSearchCursor(t.query),o=[],i=-1;n.findNext();)o.push({anchor:n.from(),head:n.to()}),n.from().line<=t.from.line&&n.from().ch<=t.from.ch&&i++;e.setSelections(o,i)}},f["Shift-"+p+"["]="fold",f["Shift-"+p+"]"]="unfold",f[y+p+"0"]=f[y+p+"j"]="unfoldAll",f[p+"I"]="findIncremental",f["Shift-"+p+"I"]="findIncrementalReverse",f[p+"H"]="replace",f.F3="findNext",f["Shift-F3"]="findPrev",e.normalizeKeyMap(f)}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,n){var o,i=e.getWrapperElement();return o=i.appendChild(document.createElement("div")),n?o.className="CodeMirror-dialog CodeMirror-dialog-bottom":o.className="CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?o.innerHTML=t:o.appendChild(t),o}function n(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(o,i,r){function s(e){if("string"==typeof e)u.value=e;else{if(c)return;c=!0,a.parentNode.removeChild(a),f.focus(),r.onClose&&r.onClose(a)}}r||(r={}),n(this,null);var l,a=t(this,o,r.bottom),c=!1,f=this,u=a.getElementsByTagName("input")[0];return u?(r.value&&(u.value=r.value,r.selectValueOnOpen!==!1&&u.select()),r.onInput&&e.on(u,"input",function(e){r.onInput(e,u.value,s)}),r.onKeyUp&&e.on(u,"keyup",function(e){r.onKeyUp(e,u.value,s)}),e.on(u,"keydown",function(t){r&&r.onKeyDown&&r.onKeyDown(t,u.value,s)||((27==t.keyCode||r.closeOnEnter!==!1&&13==t.keyCode)&&(u.blur(),e.e_stop(t),s()),13==t.keyCode&&i(u.value,t))}),r.closeOnBlur!==!1&&e.on(u,"blur",s),u.focus()):(l=a.getElementsByTagName("button")[0])&&(e.on(l,"click",function(){s(),f.focus()}),r.closeOnBlur!==!1&&e.on(l,"blur",s),l.focus()),s}),e.defineExtension("openConfirm",function(o,i,r){function s(){c||(c=!0,l.parentNode.removeChild(l),f.focus())}n(this,null);var l=t(this,o,r&&r.bottom),a=l.getElementsByTagName("button"),c=!1,f=this,u=1;a[0].focus();for(var h=0;h<a.length;++h){var d=a[h];!function(t){e.on(d,"click",function(n){e.e_preventDefault(n),s(),t&&t(f)})}(i[h]),e.on(d,"blur",function(){--u,setTimeout(function(){0>=u&&s()},200)}),e.on(d,"focus",function(){++u})}}),e.defineExtension("openNotification",function(o,i){function r(){a||(a=!0,clearTimeout(s),l.parentNode.removeChild(l))}n(this,r);var s,l=t(this,o,i&&i.bottom),a=!1,c=i&&"undefined"!=typeof i.duration?i.duration:5e3;return e.on(l,"click",function(t){e.e_preventDefault(t),r()}),c&&(s=setTimeout(r,c)),r})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t){return"pairs"==t&&"string"==typeof e?e:"object"==typeof e&&null!=e[t]?e[t]:u[t]}function n(e){return function(t){return l(t,e)}}function o(e){var t=e.state.closeBrackets;if(!t)return null;var n=e.getModeAt(e.getCursor());return n.closeBrackets||t}function i(n){var i=o(n);if(!i||n.getOption("disableInput"))return e.Pass;for(var r=t(i,"pairs"),s=n.listSelections(),l=0;l<s.length;l++){if(!s[l].empty())return e.Pass;var a=c(n,s[l].head);if(!a||r.indexOf(a)%2!=0)return e.Pass}for(var l=s.length-1;l>=0;l--){var f=s[l].head;n.replaceRange("",h(f.line,f.ch-1),h(f.line,f.ch+1))}}function r(n){var i=o(n),r=i&&t(i,"explode");if(!r||n.getOption("disableInput"))return e.Pass;for(var s=n.listSelections(),l=0;l<s.length;l++){if(!s[l].empty())return e.Pass;var a=c(n,s[l].head);if(!a||r.indexOf(a)%2!=0)return e.Pass}n.operation(function(){n.replaceSelection("\n\n",null),n.execCommand("goCharLeft"),s=n.listSelections();for(var e=0;e<s.length;e++){var t=s[e].head.line;n.indentLine(t,null,!0),n.indentLine(t+1,null,!0)}})}function s(t){var n=e.cmpPos(t.anchor,t.head)>0;return{anchor:new h(t.anchor.line,t.anchor.ch+(n?-1:1)),head:new h(t.head.line,t.head.ch+(n?1:-1))}}function l(n,i){var r=o(n);if(!r||n.getOption("disableInput"))return e.Pass;var l=t(r,"pairs"),c=l.indexOf(i);if(-1==c)return e.Pass;for(var u,d,p=t(r,"triples"),g=l.charAt(c+1)==i,m=n.listSelections(),v=c%2==0,y=0;y<m.length;y++){var b,C=m[y],x=C.head,d=n.getRange(x,h(x.line,x.ch+1));if(v&&!C.empty())b="surround";else if(!g&&v||d!=i)if(g&&x.ch>1&&p.indexOf(i)>=0&&n.getRange(h(x.line,x.ch-2),x)==i+i&&(x.ch<=2||n.getRange(h(x.line,x.ch-3),h(x.line,x.ch-2))!=i))b="addFour";else if(g){if(e.isWordChar(d)||!f(n,x,i))return e.Pass;b="both"}else{if(!v||n.getLine(x.line).length!=x.ch&&!a(d,l)&&!/\s/.test(d))return e.Pass;b="both"}else b=p.indexOf(i)>=0&&n.getRange(x,h(x.line,x.ch+3))==i+i+i?"skipThree":"skip";if(u){if(u!=b)return e.Pass}else u=b}var w=c%2?l.charAt(c-1):i,k=c%2?i:l.charAt(c+1);n.operation(function(){if("skip"==u)n.execCommand("goCharRight");else if("skipThree"==u)for(var e=0;3>e;e++)n.execCommand("goCharRight");else if("surround"==u){for(var t=n.getSelections(),e=0;e<t.length;e++)t[e]=w+t[e]+k;n.replaceSelections(t,"around"),t=n.listSelections().slice();for(var e=0;e<t.length;e++)t[e]=s(t[e]);n.setSelections(t)}else"both"==u?(n.replaceSelection(w+k,null),n.triggerElectric(w+k),n.execCommand("goCharLeft")):"addFour"==u&&(n.replaceSelection(w+w+w+w,"before"),n.execCommand("goCharRight"))})}function a(e,t){var n=t.lastIndexOf(e);return n>-1&&n%2==1}function c(e,t){var n=e.getRange(h(t.line,t.ch-1),h(t.line,t.ch+1));return 2==n.length?n:null}function f(t,n,o){var i=t.getLine(n.line),r=t.getTokenAt(n);if(/\bstring2?\b/.test(r.type))return!1;var s=new e.StringStream(i.slice(0,n.ch)+o+i.slice(n.ch),4);for(s.pos=s.start=r.start;;){var l=t.getMode().token(s,r.state);if(s.pos>=n.ch+1)return/\bstring2?\b/.test(l);s.start=s.pos}}var u={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},h=e.Pos;e.defineOption("autoCloseBrackets",!1,function(t,n,o){
o&&o!=e.Init&&(t.removeKeyMap(p),t.state.closeBrackets=null),n&&(t.state.closeBrackets=n,t.addKeyMap(p))});for(var d=u.pairs+"`",p={Backspace:i,Enter:r},g=0;g<d.length;g++)p["'"+d.charAt(g)+"'"]=n(d.charAt(g))}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function t(t){if(t.getOption("disableInput"))return e.Pass;for(var n=t.listSelections(),o=[],a=0;a<n.length;a++){if(!n[a].empty())return e.Pass;var c=n[a].head,f=t.getTokenAt(c),u=e.innerMode(t.getMode(),f.state),h=u.state;if("xml"!=u.mode.name||!h.tagName)return e.Pass;var d=t.getOption("autoCloseTags"),p="html"==u.mode.configuration,g="object"==typeof d&&d.dontCloseTags||p&&s,m="object"==typeof d&&d.indentTags||p&&l,v=h.tagName;f.end>c.ch&&(v=v.slice(0,v.length-f.end+c.ch));var y=v.toLowerCase();if(!v||"string"==f.type&&(f.end!=c.ch||!/[\"\']/.test(f.string.charAt(f.string.length-1))||1==f.string.length)||"tag"==f.type&&"closeTag"==h.type||f.string.indexOf("/")==f.string.length-1||g&&i(g,y)>-1||r(t,v,c,h,!0))return e.Pass;var b=m&&i(m,y)>-1;o[a]={indent:b,text:">"+(b?"\n\n":"")+"</"+v+">",newPos:b?e.Pos(c.line+1,0):e.Pos(c.line,c.ch+1)}}for(var a=n.length-1;a>=0;a--){var C=o[a];t.replaceRange(C.text,n[a].head,n[a].anchor,"+insert");var x=t.listSelections().slice(0);x[a]={head:C.newPos,anchor:C.newPos},t.setSelections(x),C.indent&&(t.indentLine(C.newPos.line,null,!0),t.indentLine(C.newPos.line+1,null,!0))}}function n(t,n){for(var o=t.listSelections(),i=[],s=n?"/":"</",l=0;l<o.length;l++){if(!o[l].empty())return e.Pass;var a=o[l].head,c=t.getTokenAt(a),f=e.innerMode(t.getMode(),c.state),u=f.state;if(n&&("string"==c.type||"<"!=c.string.charAt(0)||c.start!=a.ch-1))return e.Pass;var h;if("xml"!=f.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==f.mode.name)h=s+"script";else{if("htmlmixed"!=t.getMode().name||"css"!=f.mode.name)return e.Pass;h=s+"style"}else{if(!u.context||!u.context.tagName||r(t,u.context.tagName,a,u))return e.Pass;h=s+u.context.tagName}">"!=t.getLine(a.line).charAt(c.end)&&(h+=">"),i[l]=h}t.replaceSelections(i),o=t.listSelections();for(var l=0;l<o.length;l++)(l==o.length-1||o[l].head.line<o[l+1].head.line)&&t.indentLine(o[l].head.line)}function o(t){return t.getOption("disableInput")?e.Pass:n(t,!0)}function i(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;o>n;++n)if(e[n]==t)return n;return-1}function r(t,n,o,i,r){if(!e.scanForClosingTag)return!1;var s=Math.min(t.lastLine()+1,o.line+500),l=e.scanForClosingTag(t,o,null,s);if(!l||l.tag!=n)return!1;for(var a=i.context,c=r?1:0;a&&a.tagName==n;a=a.prev)++c;o=l.to;for(var f=1;c>f;f++){var u=e.scanForClosingTag(t,o,null,s);if(!u||u.tag!=n)return!1;o=u.to}return!0}e.defineOption("autoCloseTags",!1,function(n,i,r){if(r!=e.Init&&r&&n.removeKeyMap("autoCloseTags"),i){var s={name:"autoCloseTags"};("object"!=typeof i||i.whenClosing)&&(s["'/'"]=function(e){return o(e)}),("object"!=typeof i||i.whenOpening)&&(s["'>'"]=function(e){return t(e)}),n.addKeyMap(s)}});var s=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],l=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];e.commands.closeTag=function(e){return n(e)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-]\s|(\d+)([.)]))(\s*)/,n=/^(\s*)(>[> ]*|[*+-]|(\d+)[.)])(\s*)$/,o=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(i){if(i.getOption("disableInput"))return e.Pass;for(var r=i.listSelections(),s=[],l=0;l<r.length;l++){var a=r[l].head,c=i.getStateAfter(a.line),f=c.list!==!1,u=0!==c.quote,h=i.getLine(a.line),d=t.exec(h);if(!r[l].empty()||!f&&!u||!d)return void i.execCommand("newlineAndIndent");if(n.test(h))i.replaceRange("",{line:a.line,ch:0},{line:a.line,ch:a.ch+1}),s[l]="\n";else{var p=d[1],g=d[5],m=o.test(d[2])||d[2].indexOf(">")>=0?d[2]:parseInt(d[3],10)+1+d[4];s[l]="\n"+p+m+g}}i.replaceSelections(s)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,o,i){var r=e.getLineHandle(t.line),a=t.ch-1,c=a>=0&&l[r.text.charAt(a)]||l[r.text.charAt(++a)];if(!c)return null;var f=">"==c.charAt(1)?1:-1;if(o&&f>0!=(a==t.ch))return null;var u=e.getTokenTypeAt(s(t.line,a+1)),h=n(e,s(t.line,a+(f>0?1:0)),f,u||null,i);return null==h?null:{from:s(t.line,a),to:h&&h.pos,match:h&&h.ch==c.charAt(0),forward:f>0}}function n(e,t,n,o,i){for(var r=i&&i.maxScanLineLength||1e4,a=i&&i.maxScanLines||1e3,c=[],f=i&&i.bracketRegex?i.bracketRegex:/[(){}[\]]/,u=n>0?Math.min(t.line+a,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-a),h=t.line;h!=u;h+=n){var d=e.getLine(h);if(d){var p=n>0?0:d.length-1,g=n>0?d.length:-1;if(!(d.length>r))for(h==t.line&&(p=t.ch-(0>n?1:0));p!=g;p+=n){var m=d.charAt(p);if(f.test(m)&&(void 0===o||e.getTokenTypeAt(s(h,p+1))==o)){var v=l[m];if(">"==v.charAt(1)==n>0)c.push(m);else{if(!c.length)return{pos:s(h,p),ch:m};c.pop()}}}}}return h-n==(n>0?e.lastLine():e.firstLine())?!1:null}function o(e,n,o){for(var i=e.state.matchBrackets.maxHighlightLineLength||1e3,l=[],a=e.listSelections(),c=0;c<a.length;c++){var f=a[c].empty()&&t(e,a[c].head,!1,o);if(f&&e.getLine(f.from.line).length<=i){var u=f.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";l.push(e.markText(f.from,s(f.from.line,f.from.ch+1),{className:u})),f.to&&e.getLine(f.to.line).length<=i&&l.push(e.markText(f.to,s(f.to.line,f.to.ch+1),{className:u}))}}if(l.length){r&&e.state.focused&&e.focus();var h=function(){e.operation(function(){for(var e=0;e<l.length;e++)l[e].clear()})};if(!n)return h;setTimeout(h,800)}}function i(e){e.operation(function(){a&&(a(),a=null),a=o(e,!1,e.state.matchBrackets)})}var r=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),s=e.Pos,l={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},a=null;e.defineOption("matchBrackets",!1,function(t,n,o){o&&o!=e.Init&&t.off("cursorActivity",i),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",i))}),e.defineExtension("matchBrackets",function(){o(this,!0)}),e.defineExtension("findMatchingBracket",function(e,n,o){return t(this,e,n,o)}),e.defineExtension("scanForBracket",function(e,t,o,i){return n(this,e,t,o,i)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){"use strict";function t(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function n(n){n.state.failedTagMatch=!1,n.operation(function(){if(t(n),!n.somethingSelected()){var o=n.getCursor(),i=n.getViewport();i.from=Math.min(i.from,o.line),i.to=Math.max(o.line+1,i.to);var r=e.findMatchingTag(n,o,i);if(r){if(n.state.matchBothTags){var s="open"==r.at?r.open:r.close;s&&(n.state.tagHit=n.markText(s.from,s.to,{className:"CodeMirror-matchingtag"}))}var l="close"==r.at?r.open:r.close;l?n.state.tagOther=n.markText(l.from,l.to,{className:"CodeMirror-matchingtag"}):n.state.failedTagMatch=!0}}})}function o(e){e.state.failedTagMatch&&n(e)}e.defineOption("matchTags",!1,function(i,r,s){s&&s!=e.Init&&(i.off("cursorActivity",n),i.off("viewportChange",o),t(i)),r&&(i.state.matchBothTags="object"==typeof r&&r.bothTags,i.on("cursorActivity",n),i.on("viewportChange",o),n(i))}),e.commands.toMatchingTag=function(t){var n=e.findMatchingTag(t,t.getCursor());if(n){var o="close"==n.at?n.open:n.close;o&&t.extendSelection(o.to,o.from)}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineOption("showTrailingSpace",!1,function(t,n,o){o==e.Init&&(o=!1),o&&!n?t.removeOverlay("trailingspace"):!o&&n&&t.addOverlay({token:function(e){for(var t=e.string.length,n=t;n&&/\s/.test(e.string.charAt(n-1));--n);return n>e.pos?(e.pos=n,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","brace",function(t,n){function o(o){for(var i=n.ch,a=0;;){var c=0>=i?-1:l.lastIndexOf(o,i-1);if(-1!=c){if(1==a&&c<n.ch)break;if(r=t.getTokenTypeAt(e.Pos(s,c+1)),!/^(comment|string)/.test(r))return c+1;i=c-1}else{if(1==a)break;a=1,i=l.length}}}var i,r,s=n.line,l=t.getLine(s),a="{",c="}",i=o("{");if(null==i&&(a="[",c="]",i=o("[")),null!=i){var f,u,h=1,d=t.lastLine();e:for(var p=s;d>=p;++p)for(var g=t.getLine(p),m=p==s?i:0;;){var v=g.indexOf(a,m),y=g.indexOf(c,m);if(0>v&&(v=g.length),0>y&&(y=g.length),m=Math.min(v,y),m==g.length)break;if(t.getTokenTypeAt(e.Pos(p,m+1))==r)if(m==v)++h;else if(!--h){f=p,u=m;break e}++m}if(null!=f&&(s!=f||u!=i))return{from:e.Pos(s,i),to:e.Pos(f,u)}}}),e.registerHelper("fold","import",function(t,n){function o(n){if(n<t.firstLine()||n>t.lastLine())return null;var o=t.getTokenAt(e.Pos(n,1));if(/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"keyword"!=o.type||"import"!=o.string)return null;for(var i=n,r=Math.min(t.lastLine(),n+10);r>=i;++i){var s=t.getLine(i),l=s.indexOf(";");if(-1!=l)return{startCh:o.end,end:e.Pos(i,l)}}}var i,n=n.line,r=o(n);if(!r||o(n-1)||(i=o(n-2))&&i.end.line==n-1)return null;for(var s=r.end;;){var l=o(s.line+1);if(null==l)break;s=l.end}return{from:t.clipPos(e.Pos(n,r.startCh+1)),to:s}}),e.registerHelper("fold","include",function(t,n){function o(n){if(n<t.firstLine()||n>t.lastLine())return null;var o=t.getTokenAt(e.Pos(n,1));return/\S/.test(o.string)||(o=t.getTokenAt(e.Pos(n,o.end+1))),"meta"==o.type&&"#include"==o.string.slice(0,8)?o.start+8:void 0}var n=n.line,i=o(n);if(null==i||null!=o(n-1))return null;for(var r=n;;){var s=o(r+1);if(null==s)break;++r}return{from:e.Pos(n,i+1),to:t.clipPos(e.Pos(r))}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,n){var o=t.getModeAt(n),i=o.blockCommentStart,r=o.blockCommentEnd;if(i&&r){for(var s,l=n.line,a=t.getLine(l),c=n.ch,f=0;;){var u=0>=c?-1:a.lastIndexOf(i,c-1);if(-1!=u){if(1==f&&u<n.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(l,u+1)))){s=u+i.length;break}c=u-1}else{if(1==f)return;f=1,c=a.length}}var h,d,p=1,g=t.lastLine();e:for(var m=l;g>=m;++m)for(var v=t.getLine(m),y=m==l?s:0;;){var b=v.indexOf(i,y),C=v.indexOf(r,y);if(0>b&&(b=v.length),0>C&&(C=v.length),y=Math.min(b,C),y==v.length)break;if(y==b)++p;else if(!--p){h=m,d=y;break e}++y}if(null!=h&&(l!=h||d!=s))return{from:e.Pos(l,s),to:e.Pos(h,d)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,i,r,s){function l(e){var n=a(t,i);if(!n||n.to.line-n.from.line<c)return null;for(var o=t.findMarksAt(n.from),r=0;r<o.length;++r)if(o[r].__isFold&&"fold"!==s){if(!e)return null;n.cleared=!0,o[r].clear()}return n}if(r&&r.call){var a=r;r=null}else var a=o(t,r,"rangeFinder");"number"==typeof i&&(i=e.Pos(i,0));var c=o(t,r,"minFoldSize"),f=l(!0);if(o(t,r,"scanUp"))for(;!f&&i.line>t.firstLine();)i=e.Pos(i.line-1,0),f=l(!1);if(f&&!f.cleared&&"unfold"!==s){var u=n(t,r);e.on(u,"mousedown",function(t){h.clear(),e.e_preventDefault(t)});var h=t.markText(f.from,f.to,{replacedWith:u,clearOnEnter:!0,__isFold:!0});h.on("clear",function(n,o){e.signal(t,"unfold",t,n,o)}),e.signal(t,"fold",t,f.from,f.to)}}function n(e,t){var n=o(e,t,"widget");if("string"==typeof n){var i=document.createTextNode(n);n=document.createElement("span"),n.appendChild(i),n.className="CodeMirror-foldmarker"}return n}function o(e,t,n){if(t&&void 0!==t[n])return t[n];var o=e.options.foldOptions;return o&&void 0!==o[n]?o[n]:i[n]}e.newFoldFunction=function(e,n){return function(o,i){t(o,i,{rangeFinder:e,widget:n})}},e.defineExtension("foldCode",function(e,n,o){t(this,e,n,o)}),e.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),n=0;n<t.length;++n)if(t[n].__isFold)return!0}),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation(function(){for(var n=t.firstLine(),o=t.lastLine();o>=n;n++)t.foldCode(e.Pos(n,0),null,"fold")})},e.commands.unfoldAll=function(t){t.operation(function(){for(var n=t.firstLine(),o=t.lastLine();o>=n;n++)t.foldCode(e.Pos(n,0),null,"unfold")})},e.registerHelper("fold","combine",function(){var e=Array.prototype.slice.call(arguments,0);return function(t,n){for(var o=0;o<e.length;++o){var i=e[o](t,n);if(i)return i}}}),e.registerHelper("fold","auto",function(e,t){for(var n=e.getHelpers(t,"fold"),o=0;o<n.length;o++){var i=n[o](e,t);if(i)return i}});var i={rangeFinder:e.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1};e.defineOption("foldOptions",null),e.defineExtension("foldOption",function(e,t){return o(this,e,t)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}(function(e){"use strict";function t(e){this.options=e,this.from=this.to=0}function n(e){return e===!0&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function o(e,t){for(var n=e.findMarksAt(u(t)),o=0;o<n.length;++o)if(n[o].__isFold&&n[o].find().from.line==t)return n[o]}function i(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function r(e,t,n){var r=e.state.foldGutter.options,s=t,l=e.foldOption(r,"minFoldSize"),a=e.foldOption(r,"rangeFinder");e.eachLine(t,n,function(t){var n=null;if(o(e,s))n=i(r.indicatorFolded);else{var c=u(s,0),f=a&&a(e,c);f&&f.to.line-f.from.line>=l&&(n=i(r.indicatorOpen))}e.setGutterMarker(t,r.gutter,n),++s})}function s(e){var t=e.getViewport(),n=e.state.foldGutter;n&&(e.operation(function(){r(e,t.from,t.to)}),n.from=t.from,n.to=t.to)}function l(e,t,n){var i=e.state.foldGutter;if(i){var r=i.options;if(n==r.gutter){var s=o(e,t);s?s.clear():e.foldCode(u(t,0),r.rangeFinder)}}}function a(e){var t=e.state.foldGutter;if(t){var n=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){s(e)},n.foldOnChangeTimeSpan||600)}}function c(e){var t=e.state.foldGutter;if(t){var n=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){var n=e.getViewport();t.from==t.to||n.from-t.to>20||t.from-n.to>20?s(e):e.operation(function(){n.from<t.from&&(r(e,n.from,t.from),t.from=n.from),n.to>t.to&&(r(e,t.to,n.to),t.to=n.to)})},n.updateViewportTimeSpan||400)}}function f(e,t){var n=e.state.foldGutter;if(n){var o=t.line;o>=n.from&&o<n.to&&r(e,o,o+1)}}e.defineOption("foldGutter",!1,function(o,i,r){r&&r!=e.Init&&(o.clearGutter(o.state.foldGutter.options.gutter),o.state.foldGutter=null,o.off("gutterClick",l),o.off("change",a),o.off("viewportChange",c),o.off("fold",f),o.off("unfold",f),o.off("swapDoc",s)),i&&(o.state.foldGutter=new t(n(i)),s(o),o.on("gutterClick",l),o.on("change",a),o.on("viewportChange",c),o.on("fold",f),o.on("unfold",f),o.on("swapDoc",s))});var u=e.Pos}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","indent",function(t,n){var o=t.getOption("tabSize"),i=t.getLine(n.line);if(/\S/.test(i)){for(var r=function(t){return e.countColumn(t,null,o)},s=r(i),l=null,a=n.line+1,c=t.lastLine();c>=a;++a){var f=t.getLine(a),u=r(f);if(u>s)l=a;else if(/\S/.test(f))break}return l?{from:e.Pos(n.line,i.length),to:e.Pos(l,t.getLine(l).length)}:void 0}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","markdown",function(t,n){function o(n){var o=t.getTokenTypeAt(e.Pos(n,0));return o&&/\bheader\b/.test(o)}function i(e,t,n){var i=t&&t.match(/^#+/);return i&&o(e)?i[0].length:(i=n&&n.match(/^[=\-]+\s*$/),i&&o(e+1)?"="==n[0]?1:2:r)}var r=100,s=t.getLine(n.line),l=t.getLine(n.line+1),a=i(n.line,s,l);if(a===r)return void 0;for(var c=t.lastLine(),f=n.line,u=t.getLine(f+2);c>f&&!(i(f+1,l,u)<=a);)++f,l=u,u=t.getLine(f+2);return{from:e.Pos(n.line,s.length),to:e.Pos(f,t.getLine(f).length)}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return e.line-t.line||e.ch-t.ch}function n(e,t,n,o){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=o?o.from:e.firstLine(),this.max=o?o.to-1:e.lastLine()}function o(e,t){var n=e.cm.getTokenTypeAt(h(e.line,t));return n&&/\btag\b/.test(n)}function i(e){return e.line>=e.max?void 0:(e.ch=0,e.text=e.cm.getLine(++e.line),!0)}function r(e){return e.line<=e.min?void 0:(e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0)}function s(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(i(e))continue;return}{if(o(e,t+1)){var n=e.text.lastIndexOf("/",t),r=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,r?"selfClose":"regular"}e.ch=t+1}}}function l(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(r(e))continue;return}if(o(e,t+1)){g.lastIndex=t,e.ch=t;var n=g.exec(e.text);if(n&&n.index==t)return n}else e.ch=t}}function a(e){for(;;){g.lastIndex=e.ch;var t=g.exec(e.text);if(!t){if(i(e))continue;return}{if(o(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function c(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(r(e))continue;return}{if(o(e,t+1)){var n=e.text.lastIndexOf("/",t),i=n>-1&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t}}}function f(e,t){for(var n=[];;){var o,i=a(e),r=e.line,l=e.ch-(i?i[0].length:0);if(!i||!(o=s(e)))return;if("selfClose"!=o)if(i[1]){for(var c=n.length-1;c>=0;--c)if(n[c]==i[2]){n.length=c;break}if(0>c&&(!t||t==i[2]))return{tag:i[2],from:h(r,l),to:h(e.line,e.ch)}}else n.push(i[2])}}function u(e,t){for(var n=[];;){var o=c(e);if(!o)return;if("selfClose"!=o){var i=e.line,r=e.ch,s=l(e);if(!s)return;if(s[1])n.push(s[2]);else{for(var a=n.length-1;a>=0;--a)if(n[a]==s[2]){n.length=a;break}if(0>a&&(!t||t==s[2]))return{tag:s[2],from:h(e.line,e.ch),to:h(i,r)}}}else l(e)}}var h=e.Pos,d="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",p=d+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",g=new RegExp("<(/?)(["+d+"]["+p+"]*)","g");e.registerHelper("fold","xml",function(e,t){for(var o=new n(e,t.line,0);;){var i,r=a(o);if(!r||o.line!=t.line||!(i=s(o)))return;if(!r[1]&&"selfClose"!=i){var t=h(o.line,o.ch),l=f(o,r[2]);return l&&{from:t,to:l.from}}}}),e.findMatchingTag=function(e,o,i){var r=new n(e,o.line,o.ch,i);if(-1!=r.text.indexOf(">")||-1!=r.text.indexOf("<")){var a=s(r),c=a&&h(r.line,r.ch),d=a&&l(r);if(a&&d&&!(t(r,o)>0)){var p={from:h(r.line,r.ch),to:c,tag:d[2]};return"selfClose"==a?{open:p,close:null,at:"open"}:d[1]?{open:u(r,d[2]),close:p,at:"close"}:(r=new n(e,c.line,c.ch,i),{open:p,close:f(r,d[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,o){for(var i=new n(e,t.line,t.ch,o);;){var r=u(i);if(!r)break;var s=new n(e,t.line,t.ch,o),l=f(s,r.tag);if(l)return{open:r,close:l}}},e.scanForClosingTag=function(e,t,o,i){var r=new n(e,t.line,t.ch,i?{from:0,to:i}:null);return f(r,o)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){"object"==typeof e&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay,this.wordsOnly=e.wordsOnly),null==this.style&&(this.style=a),null==this.minChars&&(this.minChars=l),null==this.delay&&(this.delay=c),null==this.wordsOnly&&(this.wordsOnly=f),this.overlay=this.timeout=null}function n(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout),t.timeout=setTimeout(function(){o(e)},t.delay)}function o(e){e.operation(function(){var t=e.state.matchHighlighter;if(t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null),!e.somethingSelected()&&t.showToken){for(var n=t.showToken===!0?/[\w$]/:t.showToken,o=e.getCursor(),r=e.getLine(o.line),l=o.ch,a=l;l&&n.test(r.charAt(l-1));)--l;for(;a<r.length&&n.test(r.charAt(a));)++a;return void(a>l&&e.addOverlay(t.overlay=s(r.slice(l,a),n,t.style)))}var c=e.getCursor("from"),f=e.getCursor("to");if(c.line==f.line&&(!t.wordsOnly||i(e,c,f))){var u=e.getRange(c,f).replace(/^\s+|\s+$/g,"");u.length>=t.minChars&&e.addOverlay(t.overlay=s(u,!1,t.style))}})}function i(e,t,n){var o=e.getRange(t,n);if(null!==o.match(/^\w+$/)){if(t.ch>0){var i={line:t.line,ch:t.ch-1},r=e.getRange(i,t);if(null===r.match(/\W/))return!1}if(n.ch<e.getLine(t.line).length){var i={line:n.line,ch:n.ch+1},r=e.getRange(n,i);if(null===r.match(/\W/))return!1}return!0}return!1}function r(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}function s(e,t,n){return{token:function(o){return!o.match(e)||t&&!r(o,t)?(o.next(),void(o.skipTo(e.charAt(0))||o.skipToEnd())):n}}}var l=2,a="matchhighlight",c=100,f=!1;e.defineOption("highlightSelectionMatches",!1,function(i,r,s){if(s&&s!=e.Init){var l=i.state.matchHighlighter.overlay;l&&i.removeOverlay(l),clearTimeout(i.state.matchHighlighter.timeout),i.state.matchHighlighter=null,i.off("cursorActivity",n)}r&&(i.state.matchHighlighter=new t(r),o(i),i.on("cursorActivity",n))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,n,o){this.cm=e,this.options=o;var i={listenForChanges:!1};for(var r in o)i[r]=o[r];i.className||(i.className="CodeMirror-search-match"),this.annotation=e.annotateScrollbar(i),this.query=t,this.caseFold=n,this.gap={from:e.firstLine(),to:e.lastLine()+1},this.matches=[],this.update=null,this.findMatches(),this.annotation.update(this.matches);var s=this;e.on("change",this.changeHandler=function(e,t){s.onChange(t)})}function n(e,t,n){return t>=e?e:Math.max(t,e+n)}e.defineExtension("showMatchesOnScrollbar",function(e,n,o){return"string"==typeof o&&(o={className:o}),o||(o={}),new t(this,e,n,o)});var o=1e3;t.prototype.findMatches=function(){if(this.gap){for(var t=0;t<this.matches.length;t++){var n=this.matches[t];if(n.from.line>=this.gap.to)break;n.to.line>=this.gap.from&&this.matches.splice(t--,1)}for(var i=this.cm.getSearchCursor(this.query,e.Pos(this.gap.from,0),this.caseFold),r=this.options&&this.options.maxMatches||o;i.findNext();){var n={from:i.from(),to:i.to()};if(n.from.line>=this.gap.to)break;if(this.matches.splice(t++,0,n),this.matches.length>r)break}this.gap=null}},t.prototype.onChange=function(t){var o=t.from.line,i=e.changeEnd(t).line,r=i-t.to.line;if(this.gap?(this.gap.from=Math.min(n(this.gap.from,o,r),t.from.line),this.gap.to=Math.max(n(this.gap.to,o,r),t.from.line)):this.gap={from:t.from.line,to:i+1},r)for(var s=0;s<this.matches.length;s++){var l=this.matches[s],a=n(l.from.line,o,r);a!=l.from.line&&(l.from=e.Pos(a,l.from.ch));var c=n(l.to.line,o,r);c!=l.to.line&&(l.to=e.Pos(c,l.to.ch))}clearTimeout(this.update);var f=this;this.update=setTimeout(function(){f.updateAfterChange()},250)},t.prototype.updateAfterChange=function(){this.findMatches(),this.annotation.update(this.matches)},t.prototype.clear=function(){this.cm.off("change",this.changeHandler),this.annotation.clear()}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var n=e.exec(t.string);return n&&n.index==t.pos?(t.pos+=n[0].length,"searching"):void(n?t.pos=n.index:t.skipToEnd())}}}function n(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function o(e){return e.state.search||(e.state.search=new n)}function i(e){return"string"==typeof e&&e==e.toLowerCase()}function r(e,t,n){return e.getSearchCursor(t,n,i(t))}function s(e,t,n,o){e.openDialog(t,o,{value:n,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){p(e)}})}function l(e,t,n,o,i){e.openDialog?e.openDialog(t,i,{value:o,selectValueOnOpen:!0}):i(prompt(n,o))}function a(e,t,n,o){e.openConfirm?e.openConfirm(t,o):confirm(n)&&o[0]()}function c(e){return e.replace(/\\(.)/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":t})}function f(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(n){}else e=c(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function u(e,n,o){n.queryText=o,n.query=f(o),e.removeOverlay(n.overlay,i(n.query)),n.overlay=t(n.query,i(n.query)),e.addOverlay(n.overlay),e.showMatchesOnScrollbar&&(n.annotate&&(n.annotate.clear(),n.annotate=null),n.annotate=e.showMatchesOnScrollbar(n.query,i(n.query)))}function h(t,n,i){var r=o(t);if(r.query)return d(t,n);var a=t.getSelection()||r.lastQuery;if(i&&t.openDialog){var c=null;s(t,v,a,function(n,o){e.e_stop(o),n&&(n!=r.queryText&&u(t,r,n),c&&(c.style.opacity=1),d(t,o.shiftKey,function(e,n){var o;n.line<3&&document.querySelector&&(o=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&o.getBoundingClientRect().bottom-4>t.cursorCoords(n,"window").top&&((c=o).style.opacity=.4)}))})}else l(t,v,"Search for:",a,function(e){e&&!r.query&&t.operation(function(){u(t,r,e),r.posFrom=r.posTo=t.getCursor(),d(t,n)})})}function d(t,n,i){t.operation(function(){var s=o(t),l=r(t,s.query,n?s.posFrom:s.posTo);(l.find(n)||(l=r(t,s.query,n?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0)),l.find(n)))&&(t.setSelection(l.from(),l.to()),t.scrollIntoView({from:l.from(),to:l.to()},20),s.posFrom=l.from(),s.posTo=l.to(),i&&i(l.from(),l.to()))})}function p(e){e.operation(function(){var t=o(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function g(e,t,n){e.operation(function(){for(var o=r(e,t);o.findNext();)if("string"!=typeof t){var i=e.getRange(o.from(),o.to()).match(t);o.replace(n.replace(/\$(\d)/g,function(e,t){return i[t]}))}else o.replace(n)})}function m(e,t){if(!e.getOption("readOnly")){var n=e.getSelection()||o(e).lastQuery,i=t?"Replace all:":"Replace:";l(e,i+y,i,n,function(n){n&&(n=f(n),l(e,b,"Replace with:","",function(o){if(o=c(o),t)g(e,n,o);else{p(e);var i=r(e,n,e.getCursor()),s=function(){var t,c=i.from();!(t=i.findNext())&&(i=r(e,n),!(t=i.findNext())||c&&i.from().line==c.line&&i.from().ch==c.ch)||(e.setSelection(i.from(),i.to()),e.scrollIntoView({from:i.from(),to:i.to()}),a(e,C,"Replace?",[function(){l(t)},s,function(){g(e,n,o)}]))},l=function(e){i.replace("string"==typeof n?o:o.replace(/\$(\d)/g,function(t,n){return e[n]})),s()};s()}}))})}}var v='Search: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',y=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',b='With: <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',C="Replace? <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>";e.commands.find=function(e){p(e),h(e)},e.commands.findPersistent=function(e){p(e),h(e,!1,!0)},e.commands.findNext=h,e.commands.findPrev=function(e){h(e,!0)},e.commands.clearSearch=p,e.commands.replace=m,e.commands.replaceAll=function(e){m(e,!0)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,i,r){if(this.atOccurrence=!1,this.doc=e,null==r&&"string"==typeof t&&(r=!1),i=i?e.clipPos(i):o(0,0),this.pos={from:i,to:i},"string"!=typeof t)t.global||(t=new RegExp(t.source,t.ignoreCase?"ig":"g")),this.matches=function(n,i){if(n){t.lastIndex=0;for(var r,s,l=e.getLine(i.line).slice(0,i.ch),a=0;;){t.lastIndex=a;var c=t.exec(l);if(!c)break;if(r=c,s=r.index,a=r.index+(r[0].length||1),a==l.length)break}var f=r&&r[0].length||0;f||(0==s&&0==l.length?r=void 0:s!=e.getLine(i.line).length&&f++)}else{t.lastIndex=i.ch;var l=e.getLine(i.line),r=t.exec(l),f=r&&r[0].length||0,s=r&&r.index;s+f==l.length||f||(f=1)}return r&&f?{from:o(i.line,s),to:o(i.line,s+f),match:r}:void 0};else{var s=t;r&&(t=t.toLowerCase());var l=r?function(e){return e.toLowerCase()}:function(e){return e},a=t.split("\n");if(1==a.length)t.length?this.matches=function(i,r){if(i){var a=e.getLine(r.line).slice(0,r.ch),c=l(a),f=c.lastIndexOf(t);if(f>-1)return f=n(a,c,f),{from:o(r.line,f),to:o(r.line,f+s.length)}}else{var a=e.getLine(r.line).slice(r.ch),c=l(a),f=c.indexOf(t);if(f>-1)return f=n(a,c,f)+r.ch,{from:o(r.line,f),to:o(r.line,f+s.length)}}}:this.matches=function(){};else{var c=s.split("\n");this.matches=function(t,n){var i=a.length-1;if(t){if(n.line-(a.length-1)<e.firstLine())return;if(l(e.getLine(n.line).slice(0,c[i].length))!=a[a.length-1])return;for(var r=o(n.line,c[i].length),s=n.line-1,f=i-1;f>=1;--f,--s)if(a[f]!=l(e.getLine(s)))return;var u=e.getLine(s),h=u.length-c[0].length;if(l(u.slice(h))!=a[0])return;return{from:o(s,h),to:r}}if(!(n.line+(a.length-1)>e.lastLine())){var u=e.getLine(n.line),h=u.length-c[0].length;if(l(u.slice(h))==a[0]){for(var d=o(n.line,h),s=n.line+1,f=1;i>f;++f,++s)if(a[f]!=l(e.getLine(s)))return;if(l(e.getLine(s).slice(0,c[i].length))==a[i])return{from:d,to:o(s,c[i].length)}}}}}}}function n(e,t,n){if(e.length==t.length)return n;for(var o=Math.min(n,e.length);;){var i=e.slice(0,o).toLowerCase().length;if(n>i)++o;else{if(!(i>n))return o;--o}}}var o=e.Pos;t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t=o(e,0);return n.pos={from:t,to:t},n.atOccurrence=!1,!1}for(var n=this,i=this.doc.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,i))return this.atOccurrence=!0,
this.pos.match||!0;if(e){if(!i.line)return t(0);i=o(i.line-1,this.doc.getLine(i.line-1).length)}else{var r=this.doc.lineCount();if(i.line==r-1)return t(r);i=o(i.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(t,n){if(this.atOccurrence){var i=e.splitLines(t);this.doc.replaceRange(i,this.pos.from,this.pos.to,n),this.pos.to=o(this.pos.from.line+i.length-1,i[i.length-1].length+(1==i.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,n,o){return new t(this.doc,e,n,o)}),e.defineDocExtension("getSearchCursor",function(e,n,o){return new t(this,e,n,o)}),e.defineExtension("selectMatches",function(t,n){for(var o=[],i=this.getSearchCursor(t,this.getCursor("from"),n);i.findNext()&&!(e.cmpPos(i.to(),this.getCursor("to"))>0);)o.push({anchor:i.from(),head:i.to()});o.length&&this.setSelections(o,0)})});